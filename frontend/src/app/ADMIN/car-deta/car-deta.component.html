<div class="card">
  <p-toast />

  <!-- 1st Table: General Information (Editable) -->
  <p-table [value]="cars" dataKey="id" editMode="row" [tableStyle]="{'min-width': '50rem'}">
      <ng-template #header>
          <tr>
              <th>Name</th>
              <th>Brand</th>
              <th>Category</th>
              <th>Transmission</th>
              <th>Fuel Type</th>
              <th>Update</th>
          </tr>
      </ng-template>
      <ng-template #body let-car>
          <tr>
              <td><input pInputText [(ngModel)]="car.carName" required /></td>
              <td><input pInputText [(ngModel)]="car.brand" /></td>
              <td><input pInputText [(ngModel)]="car.category" /></td>
              <td><input pInputText [(ngModel)]="car.transmission" /></td>
              <td><input pInputText [(ngModel)]="car.carburant" /></td>
              <td>
                  <button pButton type="button" icon="pi pi-save"
                      (click)="onRowEditSave(car)" text rounded severity="secondary"></button>
              </td>
          </tr>
      </ng-template>
  </p-table>

  <!-- 2nd Table: Pricing & Availability (Editable) -->
  <p-table [value]="cars" dataKey="id" editMode="row" [tableStyle]="{'min-width': '50rem'}">
      <ng-template #header>
          <tr>
              <th>Price (USD)</th>
              <th>Available</th>
              <th>Agency</th>
              <th>Location</th>
              <th>Update</th>
          </tr>
      </ng-template>
      <ng-template #body let-car>
          <tr>
              <td><input pInputText type="number" [(ngModel)]="car.price" /></td>
              <td>
                  <p-dropdown [options]="availabilityOptions" [(ngModel)]="car.disponible"></p-dropdown>
              </td>
              <td><input pInputText [(ngModel)]="car.agence" /></td>
              <td><input pInputText [(ngModel)]="car.local" /></td>
              <td>
                  <button pButton type="button" icon="pi pi-save"
                      (click)="onRowEditSave(car)" text rounded severity="secondary"></button>
              </td>
          </tr>
      </ng-template>
  </p-table>

  <!-- Upload Car Image -->
  <h3>Update Car Image</h3>
  <div class="image-upload">
      <p-fileUpload mode="basic" [customUpload]="true" (onSelect)="onFileSelected($event)" accept="image/*"></p-fileUpload>
      <button pButton type="button" label="Upload" icon="pi pi-upload"
          (click)="uploadImage()" [disabled]="!selectedFile"></button>
  </div>

  <!-- 3rd Table: Reviews (Read-Only) -->
  <p-table [value]="cars" dataKey="id" [tableStyle]="{'min-width': '50rem'}">
      <ng-template #header>
          <tr>
              <th>Car Name</th>
              <th>User Review</th>
              <th>Rating</th>
              <th>Created At</th>
          </tr>
      </ng-template>
      <ng-template #body let-car>
          <tr *ngFor="let review of car.reviews">
              <td>{{ car.carName }}</td>
              <td>{{ review.comment }}</td>
              <td>{{ review.rating }}</td>
              <td>{{ review.createdAt | date: 'short' }}</td>
          </tr>
      </ng-template>
  </p-table>

  <!-- 4th Table: Bookings (Read-Only) -->
  <p-table [value]="cars" dataKey="id" [tableStyle]="{'min-width': '50rem'}">
      <ng-template #header>
          <tr>
              <th>Car Name</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Status</th>
              <th>Pickup Location</th>
              <th>Dropoff Location</th>
          </tr>
      </ng-template>
      <ng-template #body let-car>
          <tr *ngFor="let booking of car.bookings">
              <td>{{ car.carName }}</td>
              <td>{{ booking.startDate | date: 'short' }}</td>
              <td>{{ booking.endDate | date: 'short' }}</td>
              <td>{{ booking.status }}</td>
              <td>{{ booking.pickupLocation }}</td>
              <td>{{ booking.dropoffLocation }}</td>
          </tr>
      </ng-template>
  </p-table>
</div>
